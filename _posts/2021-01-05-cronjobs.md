---
layout: post
title: "How to Schedule Python Scripts to Automate Tasks on Ubuntu"
date: 2021-01-05
---


Cron is a scheduling daemon for Unix-like operating systems. It offers time-based scheduling and automatic execution of jobs (also referred to as 'cron jobs') and is great for the automation of maintenance-related tasks.

In this quick tutorial we'll take a look at the necessary prerequisites to successfully run a cron job on Ubuntu 20.04.


# Installation

For most Linux distribution Cron should be installed by default. To check if it is installed, run the following command in your terminal(`Ctrl`+ `Shift` + `t`):
`dpkg -l cron `

In case it is not, run the following commands to install cron using APT:

1. Update the local package index of your machine:
Opent terminal  then type
`sudo apt update && sudo apt upgrade`

2. Install cron:
`sudo apt install cron`

3. Make sure it is configured to run in the background:
`sudo systemctl enable cron`
which will give the following output:

```Synchronizing state of cron.service with SysV service script with /lib/systemd/systemd-sysv-install.```

```Executing: /lib/systemd/systemd-sysv-install enable cron```

## Setting up a jobs

First let's open crontab by typing `crontab -e` into the terminal. Pick an editor of your choice; we'll stick with nano.

Read through the information on the screen which will help you understand the basic syntax you need to set up a cronjob.

For our purposes here, we simply want to create a cronjob which executes a particular Python script once a day. For this you only need three pieces of information:
1. Your Python path;
2. the path to your Python script;
3. the correct syntax to schedule your job.

### Your Python path

Let's start with the Python path. If you want to set up a virtual environment, follow the steps below in (1); otherwise follow (2)

1. If you want to create a virtual environment for this:
    - Navigate to the location of your virtual environment. For example, let's create a directory on our desktop. For this open your terminal and type
      - `cd Desktop`
      - `mkdir my_venv`
      - `cd my_venv`
      - Now initialise the virtual environment by running: `virtualenv -p python3 venv`.
        - In case you're doing this the first time on your machine you might be asked to install `virtualenv`. Do this by running: `sudo apt install python3-virtualenv`.
      - Now run `source venv/bin/activate`. If all of this went through with no errors you're set.

2. Alternatively, if you don't want to create a virtual environment,  verify the location of your Python environment by running `which python3` (for Python 3) in your terminal. By default the output should return `/usr/bin/python3` which is the path we'll use.

### The path to your Python script

This should be self-explanatory. For the purpose of this exercise let's assume we place our Python scrip in `Desktop/my_venv`.

The Python script I'll run is called `my.py` which contains the following code:

```
####################
# Content of my.py #
####################

import datetime

# Get date and time
todaysDate = datetime.datetime.today();
# Change display format
todaysDate = todaysDate.strftime("%Y-%m-%d %H:%M:%S")
# Print
print(todaysDate)
```

### The correct syntax to trigger your cronjob

There are two components to this task if you're entirely new to this: First, you have to know how to work with the nano editor which might take some time getting used to. Secondly, you need the correct crontab syntax.

Let's start with some quick nano keyboard shortcuts which you will need in order to navigate this editor. Hit `Ctrl` + `g` to show the help menu. Note that `^` refers to the `Ctrl` key on your keyboard.
If you don't care about nano too much the only thing you really have to do in order to set up a cronjob is to scroll to the end of the file and add your crontab jobs, then exit by pressing `Ctrl` + `x`.

Now the basic contrab syntax is as follows

```
* * * * * <your python path> <path to your Python script>
| | | | |
| | | | --- Day of the week (0 - 7)
| | | ----- Month (1 - 12)
| | ------- Day of month (1 - 31)
| --------- Hour (0 - 23)
----------- Minute (0 - 59)
```

Let's say you want to run the Python script `my.py` from `Desktop/my_venv` using the virtual environment in `/home/YourName/Desktop/my_venv/` every minute run:

```
1 * * * * /home/YourName/Desktop/my_venv/venv/bin/python3 /home/YourName/Desktop/my_venv/my.py
```
and hit `Ctrl` + `x`

Alternatively, if you don't want to set up a virtual environment (and assuming that other than that you have created the same file structure as me) you can create a cron job

```
1 * * * * /usr/bin/python3 /home/YourName/Desktop/my_venv/my.py
```
and hit `Ctrl` + `x`.

For this example we want to run a cronjob every day at 7pm:

```
0 19 * * *
```

It goes without saying that this is only a very brief introduction. For more information about cron run: `man cron` or `man crontab`.
