<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to comtradeRggregator • comtradeRggregator</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to comtradeRggregator">
<meta property="og:description" content="comtradeRggregator">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">comtradeRggregator</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/comtradeRggregator.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/articles/chaining-concordance-tables.html">Chaining concordance tables</a>
    </li>
    <li>
      <a href="../articles/articles/extracting-aggregates.html">Extracting aggregated trade data</a>
    </li>
    <li>
      <a href="../articles/articles/handling-errors.html">Handling error messages</a>
    </li>
    <li>
      <a href="../articles/articles/mirror-data.html">Working with mirror data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/amannj/comtradeRggregator/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="comtradeRggregator_files/header-attrs-2.11/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to comtradeRggregator</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/amannj/comtradeRggregator/blob/master/vignettes/comtradeRggregator.Rmd"><code>vignettes/comtradeRggregator.Rmd</code></a></small>
      <div class="hidden name"><code>comtradeRggregator.Rmd</code></div>

    </div>

    
    
<p>First, load the package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/amannj/comtradeRggregator">comtradeRggregator</a></span><span class="op">)</span></code></pre></div>
<div id="main-functions" class="section level1">
<h1 class="hasAnchor">
<a href="#main-functions" class="anchor"></a>Main Functions</h1>
<p>The main functions of the <code>comtradeRggregator</code> package are described below.</p>
<div id="download_comtrade" class="section level2">
<h2 class="hasAnchor">
<a href="#download_comtrade" class="anchor"></a><code>download_Comtrade()</code>
</h2>
<p>Function <code><a href="../reference/download_Comtrade.html">download_Comtrade()</a></code> downloads and aggregates <a href="https://comtrade.un.org">Comtrade</a> trade data using <a href="https://comtrade.un.org/data/doc/api/">Comtrade’s API</a> and builds on the <a href="https://github.com/ropensci/comtradr">comtradr</a> package. For the full documentation, type <code><a href="../reference/download_Comtrade.html">?download_Comtrade</a></code> in R or visit the reference section of <code><a href="../reference/download_Comtrade.html">download_Comtrade()</a></code>.</p>
<div id="example-1" class="section level3">
<h3 class="hasAnchor">
<a href="#example-1" class="anchor"></a>Example 1</h3>
<p>To download <code>annual</code> global, i.e. <code>World</code>, <code>commodity</code> trade data in <code>USD</code> following the <code>HS2007</code> nomenclature for <code>all</code> available trade flows, i.e. imports, exports as well as <a href="https://wits.worldbank.org/WITS/wits/WITSHELP/Content/Data_Retrieval/T/Intro/B2.Exports_Versus_Reexports.htm">re-imports and re-exports</a>, at <code>AG6</code> level reported by <code>Austria</code> in <code>2018</code>, run:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">AT_World</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/download_Comtrade.html">download_Comtrade</a></span><span class="op">(</span>
  year <span class="op">=</span> <span class="st">"2018"</span>,
  frequency <span class="op">=</span> <span class="st">"annual"</span>,
  countries <span class="op">=</span> <span class="st">"Austria"</span>,
  partners <span class="op">=</span> <span class="st">"World"</span>,
  nomenclature <span class="op">=</span> <span class="st">"HS2007"</span>,
  commodity <span class="op">=</span> <span class="st">"AG6"</span>,
  type <span class="op">=</span> <span class="st">"commodities"</span>,
  select.stats <span class="op">=</span> <span class="st">"trade_value_usd"</span>,
  direction <span class="op">=</span> <span class="st">"all"</span>
<span class="op">)</span>
<span class="va">AT_World</span>
<span class="co">#&gt; # A tibble: 9,432 x 8</span>
<span class="co">#&gt;    classification period trade_flow reporter partner commodity_code commodity   </span>
<span class="co">#&gt;    &lt;chr&gt;           &lt;int&gt; &lt;chr&gt;      &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;          &lt;chr&gt;       </span>
<span class="co">#&gt;  1 H3               2018 Export     Austria  World   010110         Live horses~</span>
<span class="co">#&gt;  2 H3               2018 Import     Austria  World   010190         Live horses~</span>
<span class="co">#&gt;  3 H3               2018 Export     Austria  World   010190         Live horses~</span>
<span class="co">#&gt;  4 H3               2018 Import     Austria  World   010210         Live bovine~</span>
<span class="co">#&gt;  5 H3               2018 Export     Austria  World   010210         Live bovine~</span>
<span class="co">#&gt;  6 H3               2018 Import     Austria  World   010290         Live bovine~</span>
<span class="co">#&gt;  7 H3               2018 Export     Austria  World   010290         Live bovine~</span>
<span class="co">#&gt;  8 H3               2018 Import     Austria  World   010310         Live swine:~</span>
<span class="co">#&gt;  9 H3               2018 Export     Austria  World   010310         Live swine:~</span>
<span class="co">#&gt; 10 H3               2018 Import     Austria  World   010391         Live swine ~</span>
<span class="co">#&gt; # ... with 9,422 more rows, and 1 more variable: trade_value_usd &lt;dbl&gt;</span></code></pre></div>
</div>
<div id="example-2" class="section level3">
<h3 class="hasAnchor">
<a href="#example-2" class="anchor"></a>Example 2</h3>
<p>Sometimes you might want to extract very specific information on particular trade flows between two countries.</p>
<p>For example, to extract <code>commodity</code> <code>re-exports</code> reported by <code>Austria</code> at <code>AG6</code> level following the <code>HS2007</code> nomenclature for trade with <code>Germany</code> in <code>2018</code>, run the command below. As you can see, this returns an empty data frame. This means that there is no trade data recorded on <a href="https://comtrade.un.org">Comtrade</a> that meets the specific criteria.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/download_Comtrade.html">download_Comtrade</a></span><span class="op">(</span>
  year <span class="op">=</span> <span class="st">"2018"</span>,
  frequency <span class="op">=</span> <span class="st">"annual"</span>,
  countries <span class="op">=</span> <span class="st">"Austria"</span>,
  partners <span class="op">=</span> <span class="st">"Germany"</span>,
  nomenclature <span class="op">=</span> <span class="st">"HS2007"</span>,
  commodity <span class="op">=</span> <span class="st">"AG6"</span>,
  type <span class="op">=</span> <span class="st">"commodities"</span>,
  select.stats <span class="op">=</span> <span class="st">"trade_value_usd"</span>,
  direction <span class="op">=</span> <span class="st">"re_exports"</span>
<span class="op">)</span>
<span class="co">#&gt; # A tibble: 0 x 0</span></code></pre></div>
</div>
<div id="example-3" class="section level3">
<h3 class="hasAnchor">
<a href="#example-3" class="anchor"></a>Example 3</h3>
<p>There might be cases where you want to download a specific group of traded commodities that may potentially also be part of a different level of aggregation. In the example below, we extract Austrian exports to Germany for the commodity groups <code>65 - Headgear and parts thereof</code> (<code>AG2</code>) as well as the corresponding sub-aggregates <code>6501</code> and <code>650100</code>, respectively.<sup><a href="#fn1">1</a></sup> Also see <a href="https://amannj.github.io/resources/comtradeRggregator/articles/extracting-aggregates.html">here</a> for a more detailed discussion and some best practice advice on how to use <code>comtradeRggregator</code> in such a scenario.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/download_Comtrade.html">download_Comtrade</a></span><span class="op">(</span>year <span class="op">=</span> <span class="st">"2018"</span>,
                  frequency <span class="op">=</span> <span class="st">"annual"</span>,
                  countries <span class="op">=</span> <span class="st">"Austria"</span>,
                  partners <span class="op">=</span> <span class="st">"Germany"</span>,
                  nomenclature <span class="op">=</span> <span class="st">"HS2007"</span>,
                  commodity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"65"</span>, <span class="st">"6501"</span>, <span class="st">"650100"</span><span class="op">)</span>,
                  type <span class="op">=</span> <span class="st">"commodities"</span>,
                  select.stats <span class="op">=</span> <span class="st">"trade_value_usd"</span>,
                  direction <span class="op">=</span> <span class="st">"exports"</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 3 x 8</span>
<span class="co">#&gt;   classification period trade_flow reporter partner commodity_code commodity    </span>
<span class="co">#&gt;   &lt;chr&gt;           &lt;int&gt; &lt;chr&gt;      &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;          &lt;chr&gt;        </span>
<span class="co">#&gt; 1 H3               2018 Export     Austria  Germany 65             Headgear and~</span>
<span class="co">#&gt; 2 H3               2018 Export     Austria  Germany 6501           Hat-forms, h~</span>
<span class="co">#&gt; 3 H3               2018 Export     Austria  Germany 650100         Hat-forms, h~</span>
<span class="co">#&gt; # ... with 1 more variable: trade_value_usd &lt;int&gt;</span></code></pre></div>
<p>With this function, you can not only download specific commodity codes in this way but also complete aggregates: For example, in case you want to download all traded commodities at the 2- and 4-digit level, i.e., <code>AG2</code> and <code>AG4</code>, you can do so by changing the input argument for <code>commodity</code> of the above query to <code>commodity = c("AG2", "AG4")</code>.</p>
</div>
<div id="example-4" class="section level3">
<h3 class="hasAnchor">
<a href="#example-4" class="anchor"></a>Example 4</h3>
<p>Sometimes trade data between countries do not “add up”: For example, in 2020 country A reported USD <span class="math inline">\(X\)</span> millions exports to country B while B was reporting USD <span class="math inline">\(Y\)</span> millions, where <span class="math inline">\(X \neq Y\)</span>. In such cases it makes sense to use <a href="https://wits.worldbank.org/wits/wits/witshelp/Content/Data_Retrieval/T/Intro/B2.Imports_Exports_and_Mirror.htm">mirrored trade data</a>. The function <code><a href="../reference/download_Comtrade.html">download_Comtrade()</a></code> offers an easy option to accomplish this. The relation of the queries used for the extraction of trade data and mirrored trade data is illustrated in the example below:</p>
<p>Reported imports by Germany from Austria and reported mirrored exports by Austria to Germany are identical by definition.<sup><a href="#fn2">2</a></sup> Note that in the query below we can use either <code>tradecode</code> names or abbreviations as input arguments for <code>tradecode</code> as provided in table <a href="https://amannj.github.io/resources/comtradeRggregator/index.html#trade-classifications">Trade Classifications</a>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">IM_DE_AT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/download_Comtrade.html">download_Comtrade</a></span><span class="op">(</span>
  year <span class="op">=</span> <span class="st">"2018"</span>,
  frequency <span class="op">=</span> <span class="st">"annual"</span>,
  countries <span class="op">=</span> <span class="st">"Germany"</span>,
  partners <span class="op">=</span> <span class="st">"Austria"</span>,
  nomenclature <span class="op">=</span> <span class="st">"HS2007"</span>,
  commodity <span class="op">=</span> <span class="st">"ag6"</span>,
  select.stats <span class="op">=</span> <span class="st">"trade_value_usd"</span>,
  direction <span class="op">=</span> <span class="st">"imports"</span>,
  type <span class="op">=</span> <span class="st">"commodities"</span>,
  is.mirrorData <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span>
<span class="va">mirrX_AT_DE</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/download_Comtrade.html">download_Comtrade</a></span><span class="op">(</span>
  year <span class="op">=</span> <span class="st">"2018"</span>,
  frequency <span class="op">=</span> <span class="st">"annual"</span>,
  countries <span class="op">=</span> <span class="st">"Austria"</span>,
  partners <span class="op">=</span> <span class="st">"Germany"</span>,
  nomenclature <span class="op">=</span> <span class="st">"H3"</span>,
  commodity <span class="op">=</span> <span class="st">"ag6"</span>,
  select.stats <span class="op">=</span> <span class="st">"trade_value_usd"</span>,
  direction <span class="op">=</span> <span class="st">"exports"</span>,
  type <span class="op">=</span> <span class="st">"commodities"</span>,
  is.mirrorData <span class="op">=</span> <span class="cn">TRUE</span>,
  rm.temporaryFiles <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span>
<span class="va">IM_DE_AT</span> <span class="op">%&gt;%</span>
  <span class="fu">summarise</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">trade_value_usd</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">pull</span><span class="op">(</span><span class="op">)</span> <span class="op">/</span> <span class="va">mirrX_AT_DE</span> <span class="op">%&gt;%</span>
    <span class="fu">summarise</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">trade_value_usd</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu">pull</span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; [1] 1</span></code></pre></div>
</div>
<div id="example-5" class="section level3">
<h3 class="hasAnchor">
<a href="#example-5" class="anchor"></a>Example 5</h3>
<p>Note that in <em>Example 4</em> above, we have instructed <code><a href="../reference/download_Comtrade.html">download_Comtrade()</a></code> to keep the temporary download files (by invoking <code>rm.temporaryFiles = FALSE</code>) for query <code>mirrX_AT_DE</code> while also using this temporary data to build the completed Comtrade data from the query and load it into R. The second step happens automatically as the argument controlling this behaviour, <code>build.Comtrade</code> is set to <code>TRUE</code> by default. However, there might be cases where you only want <code><a href="../reference/download_Comtrade.html">download_Comtrade()</a></code> to download the temporary trade data files from Comtrade, and build the trade data in R at a later stage using <code>build_comtrade()</code>; more on <code>build_comtrade()</code> <a href="#build_comtrade">below</a>.</p>
<p>Below, we instruct <code><a href="../reference/download_Comtrade.html">download_Comtrade()</a></code> to run the same query as for <code>mirrX_AT_DE</code> in <em>Example 4</em>; however, by setting <code>build.Comtrade = FALSE</code> and <code>rm.temporaryFiles = FALSE</code> we ensure that the trade data downloaded from Comtrade will only be stored locally but not built and loaded into R.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mirrX_AT_DE_v2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/download_Comtrade.html">download_Comtrade</a></span><span class="op">(</span>
  year <span class="op">=</span> <span class="st">"2018"</span>,
  frequency <span class="op">=</span> <span class="st">"annual"</span>,
  countries <span class="op">=</span> <span class="st">"Austria"</span>,
  partners <span class="op">=</span> <span class="st">"Germany"</span>,
  nomenclature <span class="op">=</span> <span class="st">"H3"</span>,
  commodity <span class="op">=</span> <span class="st">"ag6"</span>,
  select.stats <span class="op">=</span> <span class="st">"trade_value_usd"</span>,
  direction <span class="op">=</span> <span class="st">"exports"</span>,
  type <span class="op">=</span> <span class="st">"commodities"</span>,
  is.mirrorData <span class="op">=</span> <span class="cn">TRUE</span>,
  rm.temporaryFiles <span class="op">=</span> <span class="cn">FALSE</span>,
  build.Comtrade <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span>
<span class="co">#&gt; Data download complete. Please see location specified in argument</span>
<span class="co">#&gt; `location.temporaryFiles` for location of temporary files.</span></code></pre></div>
<p>The object itself is a null object.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mirrX_AT_DE_v2</span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#&gt; NULL</span></code></pre></div>
</div>
<div id="example-6" class="section level3">
<h3 class="hasAnchor">
<a href="#example-6" class="anchor"></a>Example 6</h3>
<p><code>comtradeRggregator</code> also offers simple options to download mirrored global trade data by downloading mirrored bilateral trade flows and aggregating it up to mirrored global trade data. In the simple example below, we download mirrored trade data for Austria. By setting <code>countries = "World"</code>, the package will create a mirrored data query for all global economies for the provided specification of year, trade flow, nomenclature, level of aggregation etc., and create a ready-to-use data frame.</p>
<p>In other words, to get the first mirrored export commodity flow for commodity group <code>01 - Live animals; animal products</code> in the query below, data from all countries that <em>import</em> this commodity from Austria are queried and aggregated. Then, when aggregating the final data set, the ‘order’ of the trade flows is reversed, i.e. the previously downloaded <em>imports</em> are labelled as <em>mirrored exports</em>. This reversal is highlighted in column <code>reporter</code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">AT_mirr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/download_Comtrade.html">download_Comtrade</a></span><span class="op">(</span>
  year <span class="op">=</span> <span class="st">"2018"</span>,
  frequency <span class="op">=</span> <span class="st">"annual"</span>,
  countries <span class="op">=</span> <span class="st">"Austria"</span>,
  partners <span class="op">=</span> <span class="st">"World"</span>,
  nomenclature <span class="op">=</span> <span class="st">"HS2007"</span>,
  commodity <span class="op">=</span> <span class="st">"ag2"</span>,
  select.stats <span class="op">=</span> <span class="st">"trade_value_usd"</span>,
  direction <span class="op">=</span> <span class="st">"all"</span>,
  type <span class="op">=</span> <span class="st">"commodities"</span>,
  is.mirrorData <span class="op">=</span> <span class="cn">TRUE</span>,
  rm.temporaryFiles <span class="op">=</span> <span class="cn">FALSE</span>,
  build.Comtrade <span class="op">=</span> <span class="cn">TRUE</span>,
<span class="op">)</span>
<span class="va">AT_mirr</span>
<span class="co">#&gt; # A tibble: 363 x 8</span>
<span class="co">#&gt;    classification period trade_flow reporter         partner commodity_code commodity    ~ trade_value_usd</span>
<span class="co">#&gt;    &lt;chr&gt;           &lt;int&gt; &lt;chr&gt;      &lt;chr&gt;            &lt;chr&gt;   &lt;chr&gt;          &lt;chr&gt;        ~           &lt;dbl&gt;</span>
<span class="co">#&gt;  1 H3               2018 Export     Austria mirrored World   01             Live animals;~       146122111</span>
<span class="co">#&gt;  2 H3               2018 Export     Austria mirrored World   02             Meat and edib~      1279494900</span>
<span class="co">#&gt;  3 H3               2018 Export     Austria mirrored World   03             Fish and crus~        10067362</span>
<span class="co">#&gt;  4 H3               2018 Export     Austria mirrored World   04             Dairy produce~      1522685531</span>
<span class="co">#&gt;  5 H3               2018 Export     Austria mirrored World   05             Products of a~        79271602</span>
<span class="co">#&gt;  6 H3               2018 Export     Austria mirrored World   06             Live trees an~        26938801</span>
<span class="co">#&gt;  7 H3               2018 Export     Austria mirrored World   07             Edible vegeta~       142130800</span>
<span class="co">#&gt;  8 H3               2018 Export     Austria mirrored World   08             Edible fruit ~       209962703</span>
<span class="co">#&gt;  9 H3               2018 Export     Austria mirrored World   09             Coffee, tea, ~       116804431</span>
<span class="co">#&gt; 10 H3               2018 Export     Austria mirrored World   10             Cereals      ~       544971227</span>
<span class="co">#&gt; # ... with 353 more rows</span></code></pre></div>
<p>In elaborate cases such as the one above it is advisable to keep any temporarily downloaded data by setting <code>rm.temporaryFiles = FALSE</code>, and, ideally, to have access to an authenticated account; see <a href="https://comtrade.un.org/data/doc/api/">here</a> for more information. For a more practical application, please see <a href="https://amannj.github.io/resources/comtradeRggregator/articles/articles/mirror-data.html">this</a> article.</p>
<hr>
</div>
</div>
<div id="is-available_comtrade" class="section level2">
<h2 class="hasAnchor">
<a href="#is-available_comtrade" class="anchor"></a><code>is.available_Comtrade()</code>
</h2>
<p>Sometimes you might want to check if data for a particular trade classification, frequency and/or country is available via <a href="https://comtrade.un.org">Comtrade</a> before running a query. For this you can use function <code><a href="../reference/is.available_Comtrade.html">is.available_Comtrade()</a></code>. Similar to <code><a href="../reference/download_Comtrade.html">download_Comtrade()</a></code> this function uses the <a href="https://comtrade.un.org/data/da">Comtrade Data Availability file</a> which it updates once a day.<sup><a href="#fn3">3</a></sup> For the full documentation, type <code><a href="../reference/is.available_Comtrade.html">?is.available_Comtrade</a></code> in R or visit the reference section of <code><a href="../reference/is.available_Comtrade.html">is.available_Comtrade()</a></code>.</p>
<div id="example-1-1" class="section level3">
<h3 class="hasAnchor">
<a href="#example-1-1" class="anchor"></a>Example 1</h3>
<p>To get a <a href="https://tibble.tidyverse.org/">tibble</a> listing all countries for which <code>annual</code>, <code>HS2007</code> trade data is available for the year <code>2008</code>, run:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">da1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/is.available_Comtrade.html">is.available_Comtrade</a></span><span class="op">(</span>
  frequency <span class="op">=</span> <span class="st">"annual"</span>,
  nomenclature <span class="op">=</span> <span class="st">"H3"</span>,
  year <span class="op">=</span> <span class="st">'2008'</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">da1</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 x 2</span>
<span class="co">#&gt;   country               year</span>
<span class="co">#&gt;   &lt;chr&gt;                &lt;dbl&gt;</span>
<span class="co">#&gt; 1 China, Hong Kong SAR  2008</span>
<span class="co">#&gt; 2 Hungary               2008</span>
<span class="co">#&gt; 3 Iceland               2008</span>
<span class="co">#&gt; 4 Ireland               2008</span>
<span class="co">#&gt; 5 Israel                2008</span>
<span class="co">#&gt; 6 Italy                 2008</span></code></pre></div>
</div>
<div id="example-2-1" class="section level3">
<h3 class="hasAnchor">
<a href="#example-2-1" class="anchor"></a>Example 2</h3>
<p>Similarly, you might want to know if a particular country (set of countries) is available in a particular trade data set. To check if either <code>Austria</code> or <code>Germany</code> have <code>annual</code> trade data reported following the <code>HS2002</code> nomenclature for the year <code>2012</code>, run:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">da2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/is.available_Comtrade.html">is.available_Comtrade</a></span><span class="op">(</span>
  is.contained <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Austria"</span>, <span class="st">"Germany"</span><span class="op">)</span>,
  frequency <span class="op">=</span> <span class="st">"annual"</span>,
  nomenclature <span class="op">=</span> <span class="st">"H2"</span>,
  year <span class="op">=</span> <span class="st">'2012'</span>
<span class="op">)</span>
<span class="va">da2</span>
<span class="co">#&gt; # A tibble: 2 x 2</span>
<span class="co">#&gt;   country  year</span>
<span class="co">#&gt;   &lt;chr&gt;   &lt;dbl&gt;</span>
<span class="co">#&gt; 1 Germany  2012</span>
<span class="co">#&gt; 2 Austria  2012</span></code></pre></div>
<p>The same can also be done for monthly data. As seen below, only for <code>Germany</code>, <code>monthly</code> trade data for January 2020 following the <code>HS2007</code> is available.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">da3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/is.available_Comtrade.html">is.available_Comtrade</a></span><span class="op">(</span>
  is.contained <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Austria"</span>, <span class="st">"Germany"</span><span class="op">)</span>,
  frequency <span class="op">=</span> <span class="st">"monthly"</span>,
  month <span class="op">=</span> <span class="st">"01"</span>,
  nomenclature <span class="op">=</span> <span class="st">"H3"</span>,
  year <span class="op">=</span> <span class="st">'2020'</span>
<span class="op">)</span>
<span class="va">da3</span>
<span class="co">#&gt; # A tibble: 1 x 2</span>
<span class="co">#&gt;   country year   </span>
<span class="co">#&gt;   &lt;chr&gt;   &lt;chr&gt;  </span>
<span class="co">#&gt; 1 Germany 2020-01</span></code></pre></div>
</div>
<div id="example-3-1" class="section level3">
<h3 class="hasAnchor">
<a href="#example-3-1" class="anchor"></a>Example 3</h3>
<p>If <code>is.fuzzy = TRUE</code>, function <code><a href="../reference/is.available_Comtrade.html">is.available_Comtrade()</a></code> supports fuzzy country name look-ups. As you can see below, there are two countries that contain a character sequence <code>ustr</code>, i.e. ‘Australia’ and ‘Austria’ for <code>annual</code> Comtrade data following the <code>H3</code>/<code>HS2017</code> nomenclature and the year <code>2019</code>. Monthly data is, however, only available for ‘Australia’.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/is.available_Comtrade.html">is.available_Comtrade</a></span><span class="op">(</span>
  is.contained <span class="op">=</span> <span class="st">"ustr"</span>,
  is.fuzzy <span class="op">=</span> <span class="cn">TRUE</span>,
  frequency <span class="op">=</span> <span class="st">"annual"</span>,
  nomenclature <span class="op">=</span> <span class="st">"HS2017"</span>,
  year <span class="op">=</span> <span class="st">'2019'</span>
<span class="op">)</span>
<span class="co">#&gt; # A tibble: 2 x 2</span>
<span class="co">#&gt;   country    year</span>
<span class="co">#&gt;   &lt;chr&gt;     &lt;dbl&gt;</span>
<span class="co">#&gt; 1 Australia  2019</span>
<span class="co">#&gt; 2 Austria    2019</span>

<span class="fu"><a href="../reference/is.available_Comtrade.html">is.available_Comtrade</a></span><span class="op">(</span>
  is.contained <span class="op">=</span> <span class="st">"ustr"</span>,
  is.fuzzy <span class="op">=</span> <span class="cn">TRUE</span>,
  frequency <span class="op">=</span> <span class="st">"monthly"</span>,
  nomenclature <span class="op">=</span> <span class="st">"HS2017"</span>,
  year <span class="op">=</span> <span class="st">'2019'</span>,
  month <span class="op">=</span> <span class="st">'05'</span>
<span class="op">)</span>
<span class="co">#&gt; # A tibble: 1 x 2</span>
<span class="co">#&gt;   country   year   </span>
<span class="co">#&gt;   &lt;chr&gt;     &lt;chr&gt;  </span>
<span class="co">#&gt; 1 Australia 2019-05</span></code></pre></div>
<hr>
</div>
</div>
<div id="convert_comtrade" class="section level2">
<h2 class="hasAnchor">
<a href="#convert_comtrade" class="anchor"></a><code>convert_Comtrade()</code>
</h2>
<p>Sometimes you might want to reclassify trade data to a different nomenclature. Function <code><a href="../reference/convert_Comtrade.html">convert_Comtrade()</a></code> offers a simple way for such conversions by providing official concordance tables from <a href="https://unstats.un.org/unsd/classifications/Econ#corresp-hs">UN Statistics Division (UNSD)</a> and the <a href="https://wits.worldbank.org/product_concordance.html">World Integrated Trade Solution (WITS)</a>. For the full documentation, type <code><a href="../reference/convert_Comtrade.html">?convert_Comtrade</a></code> in R or visit the reference section of <code><a href="../reference/convert_Comtrade.html">convert_Comtrade()</a></code>.</p>
<div id="example-1-2" class="section level3">
<h3 class="hasAnchor">
<a href="#example-1-2" class="anchor"></a>Example 1</h3>
<p>In case you want to convert the trade data you downloaded before using <code><a href="../reference/download_Comtrade.html">download_Comtrade()</a></code> from <code>H3</code> to the <em>Revision 3 standard</em> of the <em>International Standard Industrial Classification (ISIC)</em> nomenclature, i.e. <code>I3</code>, you can use the abbreviations and information from the <a href="#concordance-table">Concordance Table</a> to do so by running the command below. You can obtain more information on the concordance between <code>H3</code> and <code>I3</code> by running <code><a href="../reference/H3_I3.html">?H3_I3</a></code> in R. Furthermore, please note that for any non-matched category, a warning message is returned.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">I3</span> <span class="op">&lt;-</span> <span class="va">AT_World</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/convert_Comtrade.html">convert_Comtrade</a></span><span class="op">(</span>
    classification.from <span class="op">=</span> <span class="st">"HS2007"</span>,
    commodity.code <span class="op">=</span> <span class="st">"commodity_code"</span>,
    classification.to <span class="op">=</span> <span class="st">"I3"</span>
  <span class="op">)</span>
<span class="co">#&gt; Warning in convert_Comtrade(., classification.from = "HS2007", commodity.code</span>
<span class="co">#&gt; = "commodity_code", : The following commodity codes of column 'commodity_code'</span>
<span class="co">#&gt; could not be matched: 999999.</span>
<span class="va">I3</span> <span class="op">%&gt;%</span>
  <span class="fu">select</span><span class="op">(</span><span class="va">classification</span>, <span class="va">commodity_code</span>, <span class="va">`ISIC Revision 3 Product Code`</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 9,432 x 3</span>
<span class="co">#&gt;    classification commodity_code `ISIC Revision 3 Product Code`</span>
<span class="co">#&gt;    &lt;chr&gt;          &lt;chr&gt;          &lt;chr&gt;                         </span>
<span class="co">#&gt;  1 H3             010110         0121                          </span>
<span class="co">#&gt;  2 H3             010190         0121                          </span>
<span class="co">#&gt;  3 H3             010190         0121                          </span>
<span class="co">#&gt;  4 H3             010210         0121                          </span>
<span class="co">#&gt;  5 H3             010210         0121                          </span>
<span class="co">#&gt;  6 H3             010290         0121                          </span>
<span class="co">#&gt;  7 H3             010290         0121                          </span>
<span class="co">#&gt;  8 H3             010310         0122                          </span>
<span class="co">#&gt;  9 H3             010310         0122                          </span>
<span class="co">#&gt; 10 H3             010391         0122                          </span>
<span class="co">#&gt; # ... with 9,422 more rows</span></code></pre></div>
</div>
<div id="example-2-2" class="section level3">
<h3 class="hasAnchor">
<a href="#example-2-2" class="anchor"></a>Example 2</h3>
<p>Note that the different building blocks of <code>comtradeRggregator</code> can be chained together very conveniently using the pipe, <code>%&gt;%</code>, operator. In the example below, we want to download <code>HS2017</code> trade data for the year 2018 and convert it to the ISIC Rev. 3, <code>I3</code>, standard. Such operations are typically rather cumbersome with either <a href="https://comtrade.un.org">Comtrade</a> or <a href="https://wits.worldbank.org/">WITS</a> but can be achieved in a couple of lines of code with <code>comtradeRggregator</code> as illustrated below.</p>
<p>As before, we exploit the information provided in the <a href="#concordance-table">Concordance Table</a> to first download <code>HS2017</code> data, then convert it to <code>HS3</code>, and then again from <code>HS3</code> to <code>I3</code>. Note that the input arguments for <code>tradecode</code> and <code>classification.from</code> and <code>classification.to</code> accept both names and abbreviations for the respective <code>tradecode</code> standards as provided in table <a href="#trade-classifications">Trade Classification</a>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Step 1: Extract data from Comtrade</span>
<span class="fu"><a href="../reference/download_Comtrade.html">download_Comtrade</a></span><span class="op">(</span>
  year <span class="op">=</span> <span class="st">"2018"</span>,
  frequency <span class="op">=</span> <span class="st">"annual"</span>,
  countries <span class="op">=</span> <span class="st">"Austria"</span>,
  partners <span class="op">=</span> <span class="st">"World"</span>,
  nomenclature <span class="op">=</span> <span class="st">"HS2017"</span>,
  commodity <span class="op">=</span> <span class="st">"AG6"</span>,
  type <span class="op">=</span> <span class="st">"commodities"</span>,
  select.stats <span class="op">=</span> <span class="st">"trade_value_usd"</span>,
  direction <span class="op">=</span> <span class="st">"exports"</span>
<span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="co"># Step 2: Convert from HS2012/H4 to HS2007/H3</span>
  <span class="fu"><a href="../reference/convert_Comtrade.html">convert_Comtrade</a></span><span class="op">(</span>
    classification.from <span class="op">=</span> <span class="st">"H5"</span>,
    commodity.code <span class="op">=</span> <span class="st">"commodity_code"</span>,
    classification.to <span class="op">=</span> <span class="st">"HS2007"</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="co"># Step 3: Convert from HS2012/H4 to HS2007/H3</span>
  <span class="fu"><a href="../reference/convert_Comtrade.html">convert_Comtrade</a></span><span class="op">(</span>
    classification.from <span class="op">=</span> <span class="st">"H3"</span>,
    commodity.code <span class="op">=</span> <span class="st">"HS 2007 Product Code"</span>,
    classification.to <span class="op">=</span> <span class="st">"I3"</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">select</span><span class="op">(</span>
    `Original Comtrade Query` <span class="op">=</span> <span class="va">classification</span>,
    `HS 2017 Product Code` <span class="op">=</span> <span class="va">commodity_code</span>,
    <span class="va">`HS 2007 Product Code`</span>, <span class="va">`ISIC Revision 3 Product Code`</span>
  <span class="op">)</span>
<span class="co">#&gt; # A tibble: 4,876 x 4</span>
<span class="co">#&gt;    `Original Comtrade Query` `HS 2017 Product~ `HS 2007 Produc~ `ISIC Revision ~</span>
<span class="co">#&gt;    &lt;chr&gt;                     &lt;chr&gt;             &lt;chr&gt;            &lt;chr&gt;           </span>
<span class="co">#&gt;  1 H5                        010121            010110           0121            </span>
<span class="co">#&gt;  2 H5                        010129            010190           0121            </span>
<span class="co">#&gt;  3 H5                        010221            010210           0121            </span>
<span class="co">#&gt;  4 H5                        010229            010290           0121            </span>
<span class="co">#&gt;  5 H5                        010310            010310           0122            </span>
<span class="co">#&gt;  6 H5                        010391            010391           0122            </span>
<span class="co">#&gt;  7 H5                        010392            010392           0122            </span>
<span class="co">#&gt;  8 H5                        010410            010410           0121            </span>
<span class="co">#&gt;  9 H5                        010420            010420           0121            </span>
<span class="co">#&gt; 10 H5                        010511            010511           0122            </span>
<span class="co">#&gt; # ... with 4,866 more rows</span></code></pre></div>
<p>Please note that the chaining of concordance tables may be very intriguing; however, it’s not free of its downsides as is discussed in the article on <a href="https://amannj.github.io/resources/comtradeRggregator/articles/chaining-concordance-tables.html">chaining concordance tables</a>.</p>
<hr>
</div>
</div>
<div id="build_comtrade" class="section level2">
<h2 class="hasAnchor">
<a href="#build_comtrade" class="anchor"></a><code>build_Comtrade()</code>
</h2>
<p>Sometimes you might want to rebuild a data set using the temporary data files you downloaded from Comtrade. For example, you can use the function <code><a href="../reference/build_Comtrade.html">build_Comtrade()</a></code> whenever you have a very large data query that you would like to run over multiple days (and turn off your computer in the meantime) before building the final Comtrade database. In such a case you would set <code>rm.temporaryFiles = FALSE</code> when running <code><a href="../reference/download_Comtrade.html">download_Comtrade()</a></code> and then, after you have run all your queries, you would then point <code><a href="../reference/build_Comtrade.html">build_Comtrade()</a></code> to the location of all your temporary data files. A more practical example is provided in the next paragraph. For the full documentation, type <code><a href="../reference/build_Comtrade.html">?build_Comtrade</a></code> in R or visit the reference section of <code><a href="../reference/build_Comtrade.html">build_Comtrade()</a></code>.</p>
<div id="example-1-3" class="section level3">
<h3 class="hasAnchor">
<a href="#example-1-3" class="anchor"></a>Example 1</h3>
<p>Recall that when downloading the data frame <code>mirrX_AT_DE</code> we triggered the option <code>rm.temporaryFiles = FALSE</code> and R told us that the temporary file will be stored in:</p>
<pre><code><a href="https://rdrr.io/r/base/system.file.html">system.file("data/tmp", package = "comtradeRggregator")
</a></code></pre>
<p>We now use the function <code><a href="../reference/build_Comtrade.html">build_Comtrade()</a></code> in such cases where argument <code>directory</code> takes the location of a specific, temporary data folder as an input argument. The remaining arguments correspond to the arguments in <code><a href="../reference/download_Comtrade.html">download_Comtrade()</a></code> and have to be adjusted accordingly in case you want to divert from the defaults. For example, in case you want to delete the temporary files when using <code><a href="../reference/build_Comtrade.html">build_Comtrade()</a></code>, set <code>rm.temporaryFiles = TRUE</code>.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Location of temporary data download</span>
<span class="va">location_package</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"data/tmp"</span>, package <span class="op">=</span> <span class="st">"comtradeRggregator"</span><span class="op">)</span>
<span class="co"># Locate most recent temprarily download data package (i.e., mirrX_AT_DE)</span>
<span class="va">location_files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span><span class="va">location_package</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span><span class="va">location_package</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>

<span class="co"># Rebuilt mirrored exports from Austria to Germany in 2018</span>
<span class="va">mirrX_AT_DE_rebuilt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/build_Comtrade.html">build_Comtrade</a></span><span class="op">(</span>
  directory <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">location_package</span>, <span class="va">location_files</span>, sep <span class="op">=</span> <span class="st">"/"</span><span class="op">)</span>
<span class="op">)</span>

<span class="co"># Confirm that identical</span>
<span class="va">mirrX_AT_DE</span> <span class="op">%&gt;%</span>
  <span class="fu">summarise</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">trade_value_usd</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">pull</span><span class="op">(</span><span class="op">)</span> <span class="op">/</span> <span class="va">mirrX_AT_DE_rebuilt</span> <span class="op">%&gt;%</span>
    <span class="fu">summarise</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">trade_value_usd</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu">pull</span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; [1] 1</span></code></pre></div>
<hr>
</div>
</div>
</div>
<div id="axiliary-functions" class="section level1">
<h1 class="hasAnchor">
<a href="#axiliary-functions" class="anchor"></a>Axiliary functions</h1>
<p>The <code>comtradeRggregator</code> package comes with a set of auxiliary functions that are run in the process of executing the main functions. Typically, you would not have to execute any of them by themselves; however, some of them might come in handy at some point, which is why this short section is dedicated to them.</p>
<hr>
<div id="add_lzs" class="section level2">
<h2 class="hasAnchor">
<a href="#add_lzs" class="anchor"></a><code>add_lzs()</code>
</h2>
<p>Adds leading zeros to variable <code>var</code> of data frame such that <code>nchar(var) = length</code>. For the full documentation, type <code><a href="../reference/add_lzs.html">?add_lzs</a></code> in R or visit the reference section of <code><a href="../reference/add_lzs.html">add_lzs()</a></code>.</p>
<div id="example-1-4" class="section level3">
<h3 class="hasAnchor">
<a href="#example-1-4" class="anchor"></a>Example 1</h3>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"1"</span>, <span class="st">"11"</span>, <span class="st">"111"</span><span class="op">)</span><span class="op">)</span>

<span class="va">df</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/add_lzs.html">add_lzs</a></span><span class="op">(</span>variable <span class="op">=</span> <span class="st">"var"</span>, variable.length <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 3 x 1</span>
<span class="co">#&gt;   var  </span>
<span class="co">#&gt;   &lt;chr&gt;</span>
<span class="co">#&gt; 1 001  </span>
<span class="co">#&gt; 2 011  </span>
<span class="co">#&gt; 3 111</span></code></pre></div>
<hr>
</div>
</div>
<div id="check_token" class="section level2">
<h2 class="hasAnchor">
<a href="#check_token" class="anchor"></a><code>check_token()</code>
</h2>
<p><code>comtradeRggregator</code> is written in a way to minimise the cases where you run into usage limits imposed by the Comtrade API with an unregistered guest account. With that said, having a registered account can speed up the download process considerably as the limits for unauthenticated, i.e. guest accounts, are restricted to 100 requests per hour (per IP address or authenticated user). Consequently, you should obtain an authentication code (token) for large bulk downloads. You can then feed this token into the <code><a href="../reference/download_Comtrade.html">download_Comtrade()</a></code> function using the <code>token</code> argument. Please see <a href="https://amannj.github.io/resources/comtradeRggregator/articles/handling-errors.html#error-code-409-1">this</a> help article for a more extensive discussion on this topic. The function <code><a href="../reference/check_token.html">check_token()</a></code> checks the validity of a supplied Comtrade token as described in Comtrade’s <a href="https://comtrade.un.org/data/doc/api/#APIKey">API documentation</a>, and builds on the validation provided via the official <a href="https://comtrade.un.org/ws/CheckRights.aspx">Access Rights Information</a> mask as well as the official Comtrade API service; <a href="https://comtrade.un.org/api/swagger/ui/index#!/Auth/Auth_Authorize">see here</a>.</p>
<p><code><a href="../reference/check_token.html">check_token()</a></code> is executed every time you run <code><a href="../reference/download_Comtrade.html">download_Comtrade()</a></code>; however, you can also run it as a separate function if you want to check the validity of a particular token and without running a Comtrade query.</p>
<div id="example-1-5" class="section level3">
<h3 class="hasAnchor">
<a href="#example-1-5" class="anchor"></a>Example 1</h3>
<p>In this example we evaluate the <code><a href="../reference/check_token.html">check_token()</a></code> function when providing</p>
<ul>
<li>no token (the default):</li>
</ul>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/check_token.html">check_token</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># no token; default</span>
<span class="co">## No Comtrade token specified; download restricted to 100 queries per hour.</span></code></pre></div>
<ul>
<li>a ‘bad’, i.e., unregistered token:</li>
</ul>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bad_token</span> <span class="op">&lt;-</span>  <span class="st">"..."</span> <span class="co"># create a fake token</span>
<span class="fu"><a href="../reference/check_token.html">check_token</a></span><span class="op">(</span>token <span class="op">=</span> <span class="va">bad_token</span><span class="op">)</span>
<span class="co">## Comtrade token incorrect; download restricted to 100 queries per hour.</span></code></pre></div>
<ul>
<li>a ‘good’, i.e., registered token:</li>
</ul>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/check_token.html">check_token</a></span><span class="op">(</span>token <span class="op">=</span> <span class="va">good_token</span><span class="op">)</span>
<span class="co">## Comtrade token added; download limit set to 10,000 queries per hour.</span></code></pre></div>
<hr>
</div>
</div>
<div id="rm_temporaryfiles" class="section level2">
<h2 class="hasAnchor">
<a href="#rm_temporaryfiles" class="anchor"></a><code>rm_temporaryFiles()</code>
</h2>
<p>Removes all temporary files and folders. For the full documentation, type <code><a href="../reference/rm_temporaryFiles.html">?rm_temporaryFiles</a></code> in R or visit the reference section of <code><a href="../reference/rm_temporaryFiles.html">rm_temporaryFiles()</a></code>.</p>
<div id="example-1-6" class="section level3">
<h3 class="hasAnchor">
<a href="#example-1-6" class="anchor"></a>Example 1</h3>
<p>If there exist temporary files to be deleted, function <code><a href="../reference/rm_temporaryFiles.html">rm_temporaryFiles()</a></code> returns:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/rm_temporaryFiles.html">rm_temporaryFiles</a></span><span class="op">(</span>location.temporaryFiles <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>
<span class="co">#&gt; Temporary files deleted.</span></code></pre></div>
</div>
<div id="example-2-3" class="section level3">
<h3 class="hasAnchor">
<a href="#example-2-3" class="anchor"></a>Example 2</h3>
<p>If there are no temporary files to be deleted, function <code><a href="../reference/rm_temporaryFiles.html">rm_temporaryFiles()</a></code> returns:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/rm_temporaryFiles.html">rm_temporaryFiles</a></span><span class="op">(</span>location.temporaryFiles <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>
<span class="co">#&gt; Temporary directory already empty. Nothing to delete.</span></code></pre></div>
<hr>
</div>
</div>
</div>
<div id="footnotes" class="section level1">
<h1 class="hasAnchor">
<a href="#footnotes" class="anchor"></a>Footnotes</h1>
<p><a name="fn1">1</a>: In case you are looking for a particular commodity, e.g., ‘sheep’, but do not know the corresponding commodity code, you can use <a href="https://github.com/ropensci/comtradr">comtradr</a>’s <a href="https://docs.ropensci.org/comtradr/reference/ct_commodity_lookup.html"><code>ct_commodity_lookup()</code></a> function.</p>
<p><a name="fn2">2</a>: Note that we set <code>rm.temporaryFiles = FALSE</code> in the second query to demonstrate (i) how to <a href="https://github.com/amannj/comtradeRggregator#build_comtrade">rebuild a trade data set using temporary data files using <code>build_Comtrade()</code></a>, and (ii) the <a href="https://github.com/amannj/comtradeRggregator#rm_temporaryfiles">different return messages for <code>rm_temporaryFiles()</code></a>.</p>
<p><a name="fn3">3</a>: The same is true for <code><a href="../reference/download_Comtrade.html">download_Comtrade()</a></code>. In other words, both <code><a href="../reference/download_Comtrade.html">download_Comtrade()</a></code> and <code><a href="../reference/is.available_Comtrade.html">is.available_Comtrade()</a></code> will check the timestamp of the internally stored Comtrade Data Availability file and update it once a day using the official <a href="https://comtrade.un.org/data/da">Comtrade Data Availability</a> file. For further reference, the locally stored Comtrade Data Availability file can be accessed by typing <code>Comtrade_DA</code>, and the help page can be accessed by typing <code><a href="../reference/Comtrade_DA.html">?Comtrade_DA</a></code>.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://amannj.github.io">Juergen Amann</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
